name: pull request comment
on:
  issue_comment:                                     
    types: [created, edited, deleted]
jobs:
 aeolus-bot:
   runs-on: ubuntu-latest
   if: contains(github.event.comment.body, '@aeolus')  
   steps:
    - uses: actions/checkout@v1
    - env:
      BODY: ${{ github.event.comment.body }}
    - name: parse
      run: |
      if [[ $(echo $BODY | awk '{print $1}')=="@aeolus" ]]; then
          if [[ $(echo $BODY | awk '{print $2}')=='please' ]]; then
              command=$(echo $BODY | awk '{for (i=3; i<NF; i++) printf $i " "; print $NF}')
              echo "::set-output name=bot_msg::Thank you for being polite.  I can certainly \"$command\""
          else
              echo "::set-output name=bot_msg::Please use the magic word."
          fi
      fi
    - name: Comment on PR
      uses: actions/github-script@v6.4.0
      with:
        github-token: ${{secrets.GITHUB_TOKEN}}
        script: |
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: '${{ steps.parse.outputs.bot_msg }}'
          })`